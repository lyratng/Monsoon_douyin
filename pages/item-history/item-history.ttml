<!-- å•å“åˆ†æå†å²è®°å½•é¡µé¢ -->
<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <text class="title">å†å²è®°å½•</text>
    <text class="subtitle">æœ€è¿‘10æ¬¡å•å“åˆ†æ</text>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-icon">ğŸ“‹</view>
    <text class="loading-text">åŠ è½½å†å²è®°å½•ä¸­...</text>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:elif="{{isEmpty}}" class="empty-container">
    <view class="empty-icon">ğŸ¯</view>
    <text class="empty-title">æš‚æ— åˆ†æè®°å½•</text>
    <text class="empty-subtitle">å¿«å»åˆ†æä½ çš„ç¬¬ä¸€ä»¶å•å“å§</text>
    <button class="empty-button" bindtap="analyzeNew">
      <text class="button-text">å¼€å§‹åˆ†æ</text>
    </button>
  </view>

  <!-- å†å²è®°å½•åˆ—è¡¨ -->
  <view wx:else class="history-content">
    <!-- ä¸»å†…å®¹åŒºåŸŸ - å¯æ»šåŠ¨ -->
    <scroll-view class="main-content" scroll-y="true">
      <view class="history-list">
        <view 
          wx:for="{{historyList}}" 
          wx:key="id"
          class="history-card"
          bindtap="viewDetail"
          data-index="{{index}}"
        >
          <!-- å¡ç‰‡å¤´éƒ¨ -->
          <view class="card-header">
            <view class="item-info">
              <text class="item-category">{{item.categoryDisplay}}</text>
              <text class="item-color">{{item.colorDisplay}}</text>
            </view>
            <view class="card-actions">
              <text class="time-text">{{item.formattedTime}}</text>
              <view class="delete-btn" bindtap="deleteItem" data-index="{{index}}" catchtap="true">
                <text class="delete-icon">âœ•</text>
              </view>
            </view>
          </view>

          <!-- é€‚é…åº¦è¯„åˆ† -->
          <view class="score-section">
            <text class="score-label">é€‚é…åº¦</text>
            <view class="stars-container">
              <view 
                wx:for="{{item.scoreStars}}" 
                wx:key="*this"
                wx:for-item="star"
                class="star {{star ? 'filled' : ''}}"
              >
                â­
              </view>
            </view>
            <text class="score-text">{{item.suitabilityResult.overall_evaluation.suitability_score}}/5åˆ†</text>
          </view>

          <!-- åˆ†æç»“è®º -->
          <view class="conclusion-section">
            <text class="conclusion-text">{{item.suitabilityResult.overall_evaluation.conclusion}}</text>
          </view>

          <!-- å¿«é€Ÿåˆ†æä¿¡æ¯ -->
          <view class="quick-analysis">
            <view class="analysis-item">
              <text class="analysis-label">é¢œè‰²ï¼š</text>
              <text class="analysis-value {{item.suitabilityResult.analysis.color.fit === 'é€‚åˆ' ? 'fit-good' : item.suitabilityResult.analysis.color.fit === 'ä¸é€‚åˆ' ? 'fit-bad' : 'fit-neutral'}}">
                {{item.suitabilityResult.analysis.color.fit}}
              </text>
            </view>
            <view class="analysis-item">
              <text class="analysis-label">æè´¨ï¼š</text>
              <text class="analysis-value {{item.suitabilityResult.analysis.material.fit === 'é€‚åˆ' ? 'fit-good' : item.suitabilityResult.analysis.material.fit === 'ä¸é€‚åˆ' ? 'fit-bad' : 'fit-neutral'}}">
                {{item.suitabilityResult.analysis.material.fit}}
              </text>
            </view>
            <view class="analysis-item">
              <text class="analysis-label">é£æ ¼ï¼š</text>
              <text class="analysis-value {{item.suitabilityResult.analysis.style.fit === 'é€‚åˆ' ? 'fit-good' : item.suitabilityResult.analysis.style.fit === 'ä¸é€‚åˆ' ? 'fit-bad' : 'fit-neutral'}}">
                {{item.suitabilityResult.analysis.style.fit}}
              </text>
            </view>
          </view>

          <!-- æŸ¥çœ‹è¯¦æƒ…æç¤º -->
          <view class="view-detail-hint">
            <text class="hint-text">ç‚¹å‡»æŸ¥çœ‹è¯¦ç»†åˆ†æ</text>
            <text class="hint-arrow">â†’</text>
          </view>
        </view>
      </view>

      <!-- åº•éƒ¨é—´è· -->
      <view class="bottom-spacing"></view>
    </scroll-view>

    <!-- å›ºå®šåº•éƒ¨æ“ä½œæ  -->
    <view class="bottom-bar">
      <button class="secondary-button" bindtap="clearAll">
        <text class="button-text">æ¸…ç©ºè®°å½•</text>
      </button>
      
      <button class="primary-button" bindtap="analyzeNew">
        <text class="button-text">åˆ†ææ–°å•å“</text>
      </button>
    </view>
  </view>
</view>