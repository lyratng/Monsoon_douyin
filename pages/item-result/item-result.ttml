<!-- å•å“åˆ†æç»“æœé¡µé¢ -->
<view class="container">
  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <view class="loading-icon">ğŸ¯</view>
    <text class="loading-text">åŠ è½½ç»“æœä¸­...</text>
  </view>

  <!-- åˆ†æç»“æœå†…å®¹ -->
  <view wx:else class="result-content">
    <!-- é¡µé¢æ ‡é¢˜ -->
    <view class="page-header">
      <text class="title">å•å“åˆ†æç»“æœ</text>
    </view>

    <!-- ä¸»å†…å®¹åŒºåŸŸ - å¯æ»šåŠ¨ -->
    <scroll-view class="main-content" scroll-y="true">
      <!-- ä¸Šä¼ çš„å›¾ç‰‡å±•ç¤º -->
      <view class="image-section">
        <image 
          class="analyzed-image" 
          src="{{analysisResult.image.path}}" 
          mode="aspectFit"
          lazy-load="true"
        />
        <text class="image-label">{{analysisResult.image.name}}</text>
      </view>

      <!-- æ€»ä½“é€‚é…åº¦ -->
      <view class="overall-section">
        <view class="score-container">
          <text class="score-label">æ€»ä½“é€‚é…åº¦</text>
          <view class="stars-container">
            <view 
              wx:for="{{[1,2,3,4,5]}}" 
              wx:key="*this"
              class="star {{item <= analysisResult.suitabilityResult.overall_evaluation.suitability_score ? 'filled' : ''}}"
            >
              â­
            </view>
          </view>
          <text class="score-text">{{analysisResult.suitabilityResult.overall_evaluation.suitability_score}}/5åˆ†</text>
        </view>
        <text class="conclusion-text">{{analysisResult.suitabilityResult.overall_evaluation.conclusion}}</text>
      </view>

      <!-- è¯¦ç»†åˆ†æéƒ¨åˆ† -->
      <view class="analysis-section">
        <text class="section-title">è¯¦ç»†åˆ†æ</text>

        <!-- é¢œè‰²åˆ†æ -->
        <view class="analysis-card">
          <view class="card-header">
            <text class="card-icon">ğŸ¨</text>
            <text class="card-title">é¢œè‰²åˆ†æ</text>
            <text class="fit-badge {{analysisResult.suitabilityResult.analysis.color.fit === 'é€‚åˆ' ? 'fit-good' : analysisResult.suitabilityResult.analysis.color.fit === 'ä¸é€‚åˆ' ? 'fit-bad' : 'fit-neutral'}}">
              {{analysisResult.suitabilityResult.analysis.color.fit}}
            </text>
          </view>
          <view class="card-content">
            <view class="analysis-row">
              <text class="label">è¡£ç‰©é¢œè‰²ï¼š</text>
              <text class="value">{{analysisResult.suitabilityResult.analysis.color.clothing_color}}</text>
            </view>
            <view class="analysis-row">
              <text class="label">æ‚¨çš„å­£å‹ï¼š</text>
              <text class="value">{{analysisResult.suitabilityResult.analysis.color.person_season}}</text>
            </view>
            <text class="reason">{{analysisResult.suitabilityResult.analysis.color.reason}}</text>
          </view>
        </view>

        <!-- æè´¨åˆ†æ -->
        <view class="analysis-card">
          <view class="card-header">
            <text class="card-icon">ğŸ§µ</text>
            <text class="card-title">æè´¨åˆ†æ</text>
            <text class="fit-badge {{analysisResult.suitabilityResult.analysis.material.fit === 'é€‚åˆ' ? 'fit-good' : analysisResult.suitabilityResult.analysis.material.fit === 'ä¸é€‚åˆ' ? 'fit-bad' : 'fit-neutral'}}">
              {{analysisResult.suitabilityResult.analysis.material.fit}}
            </text>
          </view>
          <view class="card-content">
            <view class="analysis-row">
              <text class="label">è¡£ç‰©æè´¨ï¼š</text>
              <text class="value">{{analysisResult.suitabilityResult.analysis.material.clothing_material}}</text>
            </view>
            <view class="analysis-row" wx:if="{{analysisResult.suitabilityResult.analysis.material.recommended_materials.length > 0}}">
              <text class="label">æ¨èæè´¨ï¼š</text>
              <text class="value">{{analysisResult.suitabilityResult.analysis.material.recommended_materials.join('ã€')}}</text>
            </view>
            <text class="reason">{{analysisResult.suitabilityResult.analysis.material.reason}}</text>
          </view>
        </view>

        <!-- é£æ ¼åˆ†æ -->
        <view class="analysis-card">
          <view class="card-header">
            <text class="card-icon">ğŸ’«</text>
            <text class="card-title">é£æ ¼åˆ†æ</text>
            <text class="fit-badge {{analysisResult.suitabilityResult.analysis.style.fit === 'é€‚åˆ' ? 'fit-good' : analysisResult.suitabilityResult.analysis.style.fit === 'ä¸é€‚åˆ' ? 'fit-bad' : 'fit-neutral'}}">
              {{analysisResult.suitabilityResult.analysis.style.fit}}
            </text>
          </view>
          <view class="card-content">
            <view class="analysis-row">
              <text class="label">è¡£ç‰©é£æ ¼ï¼š</text>
              <text class="value">{{analysisResult.suitabilityResult.analysis.style.clothing_style}}</text>
            </view>
            <view class="analysis-row">
              <text class="label">æ‚¨çš„èƒ½é‡ï¼š</text>
              <text class="value">{{analysisResult.suitabilityResult.analysis.style.person_energy}}</text>
            </view>
            <text class="reason">{{analysisResult.suitabilityResult.analysis.style.reason}}</text>
          </view>
        </view>

        <!-- æ­é…å»ºè®® -->
        <view class="analysis-card">
          <view class="card-header">
            <text class="card-icon">ğŸ‘”</text>
            <text class="card-title">æ­é…å»ºè®®</text>
            <text class="fit-badge {{analysisResult.suitabilityResult.analysis.pairing.fit === 'é€‚åˆ' ? 'fit-good' : analysisResult.suitabilityResult.analysis.pairing.fit === 'ä¸é€‚åˆ' ? 'fit-bad' : 'fit-neutral'}}">
              {{analysisResult.suitabilityResult.analysis.pairing.fit}}
            </text>
          </view>
          <view class="card-content">
            <view wx:if="{{analysisResult.suitabilityResult.analysis.pairing.clothing_suggestions.length > 0}}" class="suggestions-list">
              <text class="label">æ­é…æ–¹æ¡ˆï¼š</text>
              <view wx:for="{{analysisResult.suitabilityResult.analysis.pairing.clothing_suggestions}}" wx:key="index" class="suggestion-item">
                <text class="suggestion-text">â€¢ {{item}}</text>
              </view>
            </view>
            <text class="reason">{{analysisResult.suitabilityResult.analysis.pairing.reason}}</text>
          </view>
        </view>
      </view>

      <!-- æ›´å¥½çš„é€‰æ‹© -->
      <view class="recommendations-section">
        <text class="section-title">ğŸŒŸ æ›´å¥½çš„é€‰æ‹©</text>
        
        <view wx:if="{{analysisResult.suitabilityResult.recommendations.better_colors.length > 0}}" class="recommendation-group">
          <text class="group-title">æ¨èé¢œè‰²</text>
          <view class="tags-container">
            <text 
              wx:for="{{analysisResult.suitabilityResult.recommendations.better_colors}}" 
              wx:key="index"
              class="tag color-tag"
            >
              {{item}}
            </text>
          </view>
        </view>

        <view wx:if="{{analysisResult.suitabilityResult.recommendations.better_materials.length > 0}}" class="recommendation-group">
          <text class="group-title">æ¨èæè´¨</text>
          <view class="tags-container">
            <text 
              wx:for="{{analysisResult.suitabilityResult.recommendations.better_materials}}" 
              wx:key="index"
              class="tag material-tag"
            >
              {{item}}
            </text>
          </view>
        </view>

        <view wx:if="{{analysisResult.suitabilityResult.recommendations.better_styles.length > 0}}" class="recommendation-group">
          <text class="group-title">æ¨èé£æ ¼</text>
          <view class="tags-container">
            <text 
              wx:for="{{analysisResult.suitabilityResult.recommendations.better_styles}}" 
              wx:key="index"
              class="tag style-tag"
            >
              {{item}}
            </text>
          </view>
        </view>
      </view>

      <!-- åº•éƒ¨é—´è· -->
      <view class="bottom-spacing"></view>
    </scroll-view>

    <!-- å›ºå®šåº•éƒ¨æ“ä½œæ  -->
    <view class="bottom-bar">
      <button class="secondary-button" bindtap="viewHistory">
        <text class="button-text">å†å²è®°å½•</text>
      </button>
      
      <button class="secondary-button" bindtap="shareResult">
        <text class="button-text">åˆ†äº«ç»“æœ</text>
      </button>
      
      <button class="primary-button" bindtap="analyzeAgain">
        <text class="button-text">å†æ¬¡åˆ†æ</text>
      </button>
    </view>
  </view>
</view>