<view class="container gradient-bg">
  <!-- 侧边栏入口按钮 -->
  <view class="menu-btn" bindtap="openSidebar">
    <view class="menu-line"></view>
    <view class="menu-line"></view>
    <view class="menu-line"></view>
  </view>
  
  <!-- 极简初始页面 -->
  <view tt:if="{{showInitial}}" class="initial-container">
    <view class="initial-hero">
      <text class="initial-title" bindtap="handleTitleClick">衣索寓言</text>
      <text class="initial-subtitle">AI穿搭风格诊断</text>
    </view>
    
    <view class="initial-actions">
      <button class="initial-btn" bindtap="startTest">开启风格之旅</button>
      <button tt:if="{{showGPT5Test}}" class="simple-btn debug" bindtap="openGPT5Test">🧪 GPT-5测试</button>
    </view>
  </view>

  <!-- 首次用户引导页面 - 使用和已有报告页面相同的布局 -->
  <view tt:elif="{{!hasReport}}" class="report-simple-container">
    <!-- 全屏背景照片 -->
    <view class="photo-background">
      <image class="main-photo" src="/assets/images/home/main-photo.png" mode="widthFix" />
    </view>
    
    <!-- 浮动内容区域 -->
    <view class="floating-content">
      <view class="simple-hero-first">
        <text class="simple-title title-lowered" bindtap="handleTitleClick">衣索寓言</text>
        <!-- 暂时隐藏：<text class="simple-subtitle">请先测试，以获得风格报告</text> -->
      </view>
      
      <view class="simple-actions">
        <button class="simple-btn primary" bindtap="startTest">开启风格之旅</button>
        <button tt:if="{{showGPT5Test}}" class="simple-btn debug" bindtap="openGPT5Test">🧪 GPT-5测试</button>
      </view>
    </view>
  </view>

  <!-- 已有报告的用户页面 - 极简风格 -->
  <view tt:else class="report-simple-container">
    <!-- 全屏背景照片 -->
    <view class="photo-background">
      <image class="main-photo" src="/assets/images/home/main-photo.png" mode="widthFix" />
    </view>
    
    <!-- 浮动内容区域 -->
    <view class="floating-content">
      <view class="simple-hero">
        <text class="simple-title title-lowered" bindtap="handleTitleClick">衣索寓言</text>
        <!-- 暂时隐藏：<text class="simple-subtitle">「衣有语，织为言」</text> -->
        <!-- 暂时隐藏：<text class="simple-description">你的专属风格报告已生成</text> -->
      </view>
      
      <view class="simple-actions">
        <button class="simple-btn primary" bindtap="viewReport">查看风格报告</button>
        <button class="simple-btn secondary" bindtap="retakeTest">重新测试</button>
        <button tt:if="{{showGPT5Test}}" class="simple-btn debug" bindtap="openGPT5Test">🧪 GPT-5测试</button>
      </view>
    </view>
  </view>
  
  <!-- 登录弹窗 -->
  <login-popup 
    show="{{showLoginPopup}}"
    inviter-openid="{{inviterOpenid}}"
    bind:loginsuccess="onLoginSuccess"
    bind:close="onLoginPopupClose"
  />
  
  <!-- 侧边栏 -->
  <sidebar 
    show="{{showSidebar}}"
    bind:close="onSidebarClose"
    bind:login="onSidebarLogin"
    bind:recharge="onSidebarRecharge"
    bind:invite="onInviteFriends"
  />
  
  <!-- 充值卡片 -->
  <recharge-card 
    show="{{showRechargeCard}}"
    is-first-charge="{{isFirstCharge}}"
    current-balance="{{coinBalance}}"
    bind:close="onRechargeCardClose"
    bind:rechargesuccess="onRechargeSuccess"
    bind:needlogin="onNeedLogin"
    bind:invite="onInviteFriends"
  />
</view>
